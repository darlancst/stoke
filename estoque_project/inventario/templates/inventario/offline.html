{% extends 'inventario/base.html' %}

{% block title %}Offline - Stoke{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <div class="card shadow-sm">
                <div class="card-body text-center py-5">
                    <i class="bi bi-wifi-off display-1 text-warning mb-3"></i>
                    <h2 class="mb-3">Você está offline</h2>
                    <p class="lead text-muted mb-4">
                        O Stoke precisa de conexão com a internet para funcionar.
                    </p>
                    
                    <div class="alert alert-info text-start mb-4">
                        <h6 class="alert-heading">
                            <i class="bi bi-info-circle-fill"></i> Por que preciso de internet?
                        </h6>
                        <ul class="mb-0 small">
                            <li><strong>Sincronização:</strong> Seus dados são salvos em tempo real na nuvem</li>
                            <li><strong>Multiplataforma:</strong> Acesse de qualquer dispositivo com os mesmos dados</li>
                            <li><strong>Segurança:</strong> Backup automático de todas as operações</li>
                            <li><strong>Sem perda:</strong> Nenhum dado fica desatualizado entre dispositivos</li>
                        </ul>
                    </div>

                    <div class="d-grid gap-2">
                        <button onclick="location.reload()" class="btn btn-primary btn-lg">
                            <i class="bi bi-arrow-clockwise"></i> Tentar Novamente
                        </button>
                        <button onclick="checkConnection()" class="btn btn-outline-secondary">
                            <i class="bi bi-wifi"></i> Verificar Conexão
                        </button>
                    </div>

                    <div id="status-message" class="mt-3 text-muted small"></div>
                </div>
            </div>

            <div class="text-center mt-4">
                <small class="text-muted">
                    <i class="bi bi-shield-check"></i> Seus dados estão seguros e serão sincronizados quando você voltar online
                </small>
            </div>
        </div>
    </div>
</div>

<script>
// Verifica conexão automaticamente
function checkConnection() {
    const statusEl = document.getElementById('status-message');
    statusEl.innerHTML = '<i class="bi bi-hourglass-split"></i> Verificando conexão...';
    
    fetch('/', { method: 'HEAD', cache: 'no-cache' })
        .then(() => {
            statusEl.innerHTML = '<span class="text-success"><i class="bi bi-check-circle-fill"></i> Conexão restabelecida! Recarregando...</span>';
            setTimeout(() => location.reload(), 1000);
        })
        .catch(() => {
            statusEl.innerHTML = '<span class="text-danger"><i class="bi bi-x-circle-fill"></i> Ainda offline. Verifique sua conexão Wi-Fi ou dados móveis.</span>';
        });
}

// Tenta reconectar automaticamente a cada 10 segundos
setInterval(() => {
    if (navigator.onLine) {
        checkConnection();
    }
}, 10000);
</script>
{% endblock %}






















