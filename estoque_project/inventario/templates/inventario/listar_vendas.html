{% extends 'inventario/base.html' %}

{% block title %}Vendas - Gestão de Estoque{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Histórico de Vendas</h1>
    <a href="{% url 'inventario:criar_venda' %}" class="btn btn-success">
        <i class="bi bi-plus-circle"></i> Registrar Nova Venda
    </a>
</div>

<div class="card">
    <div class="card-body">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>ID da Venda</th>
                    <th>Cliente</th>
                    <th>Data</th>
                    <th>Tipo</th>
                    <th>Valor Final</th>
                    <th>Seu Lucro</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                {% for venda in vendas %}
                <tr>
                    <td>
                        #{{ venda.id }}
                        {% if venda.teve_devolucao %}
                            <span class="ms-1" data-bs-toggle="tooltip" data-bs-placement="top" title="Esta venda teve itens devolvidos">
                                <i class="bi bi-arrow-return-left text-info"></i>
                            </span>
                        {% endif %}
                    </td>
                    <td>{{ venda.cliente_nome }}</td>
                    <td>{{ venda.data|date:"d/m/Y H:i" }}</td>
                    <td>{{ venda.get_tipo_venda_display }}</td>
                    <td>R$ {{ venda.valor_total|floatformat:2 }}</td>
                    <td>R$ {{ venda.meu_lucro|floatformat:2 }}</td>
                    <td>
                        <a href="{% url 'inventario:detalhar_venda' pk=venda.pk %}" class="btn btn-sm btn-info" title="Detalhes"><i class="bi bi-eye"></i></a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="7" class="text-center">Nenhuma venda registrada.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
// Ativa os tooltips do Bootstrap
document.addEventListener('DOMContentLoaded', function () {
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl)
    })
})
</script>
{% endblock %} 